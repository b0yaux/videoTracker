---
phase: 06.1-register-engine-global
plan: 01
status: complete
wave: 1
completed: 2026-01-21
---

## Summary

**Task:** Add engine global registration to Engine::setupLua()

**What was built:**
- Added `engine` global userdata to Lua state in `Engine::setupLua()` (src/core/Engine.cpp:299-300)
- Uses `SWIG_NewPointerObj()` to create Engine pointer as Lua userdata
- Uses `lua_setglobal()` to register it as "engine"
- Updated log message to confirm engine global registration

**Files modified:**
- `src/core/Engine.cpp` - Added 5 lines (comments + code + log update)

**Verification:**
- Build required to confirm compilation
- Runtime verification: check console for "Lua initialized with engine global"
- Lua verification: `print(type(engine))` should return "userdata"

**Key insight:**
- The `registerEngineGlobal()` function in videoTracker.i exists but was never called
- Inlining the 2 lines directly in Engine.cpp avoids SWIG header dependencies
- This CRITICAL fix enables ALL ScriptManager-generated scripts to access `engine:*` methods
